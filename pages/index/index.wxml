<!-- pages/index/index.wxml -->
<view class="container">
  <!-- å€’è®¡æ—¶å¡ç‰‡ -->
  <view class="card countdown-card" wx:if="{{examDate}}">
    <view class="countdown-content">
      <text class="countdown-label">{{examName ? 'è·ç¦»' + examName + 'è¿˜æœ‰' : 'è·ç¦»è€ƒè¯•è¿˜æœ‰'}}</text>
      <text class="countdown-number">{{countdownDays}}</text>
      <text class="countdown-unit">å¤©</text>
    </view>
    <view class="countdown-date">è€ƒè¯•æ—¥æœŸï¼š{{examDate}}</view>
  </view>
  
  <view class="card countdown-card empty" wx:else bindtap="goToProfile">
    <text class="countdown-hint">ç‚¹å‡»è®¾ç½®è€ƒè¯•æ—¥æœŸ</text>
  </view>

  <!-- æ ¸å¿ƒæ•°æ® -->
  <view class="card stats-card">
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number">{{stats.total}}</text>
        <text class="stat-label">æ€»é”™é¢˜</text>
      </view>
      <view class="stat-item">
        <text class="stat-number" style="color: #52c41a;">{{stats.mastered}}</text>
        <text class="stat-label">å·²æŒæ¡</text>
      </view>
      <view class="stat-item">
        <text class="stat-number" style="color: #ff4d4f;">{{stats.toReview}}</text>
        <text class="stat-label">å¾…å¤ä¹ </text>
      </view>
    </view>
    
    <view class="review-btn-wrapper" wx:if="{{stats.toReview > 0}}">
      <button class="btn-primary" bindtap="goToReview">
        å¼€å§‹å¤ä¹ ï¼ˆ{{stats.toReview}}é“ï¼‰
      </button>
    </view>
  </view>

  <!-- ä»Šæ—¥æ‰“å¡ -->
  <view class="card checkin-card">
    <view class="flex-between">
      <view>
        <view class="section-title">ğŸ“… è¿ç»­æ‰“å¡</view>
        <view class="checkin-days">
          <text class="checkin-number">{{streakDays}}</text>
          <text class="checkin-unit">å¤©</text>
        </view>
      </view>
      <view class="calendar-preview">
        <view wx:for="{{last7Days}}" wx:key="index" 
              class="calendar-day {{item.checked ? 'checked' : ''}}">
        </view>
      </view>
    </view>
  </view>

  <!-- å­¦ä¹ è¶‹åŠ¿ -->
  <view class="card chart-card">
    <view class="section-title">ğŸ“ˆ è¿‘7å¤©å¤ä¹ è¶‹åŠ¿</view>
    <view class="trend-chart">
      <view wx:for="{{trendData}}" wx:key="date" class="trend-bar-wrapper">
        <view class="trend-bar" style="height: {{item.count * 10}}rpx;"></view>
        <text class="trend-date">{{item.shortDate}}</text>
      </view>
    </view>
  </view>

  <!-- æ ‡ç­¾åˆ†å¸ƒ -->
  <view class="card tags-card">
    <view class="section-title">ğŸ·ï¸ æ ‡ç­¾åˆ†å¸ƒ TOP5</view>
    <view class="tag-list">
      <view wx:for="{{topTags}}" wx:key="name" class="tag-item">
        <view class="tag-info">
          <text class="tag-name">{{item.name}}</text>
          <text class="tag-count">{{item.count}}é“</text>
        </view>
        <view class="tag-bar-wrapper">
          <view class="tag-bar" style="width: {{item.percent}}%;"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«é€Ÿå½•å…¥ -->
  <view class="card quick-add-card" bindtap="goToAdd">
    <view class="quick-add-content">
      <text class="quick-add-icon">ğŸ“·</text>
      <text class="quick-add-text">æ‹ç…§å½•å…¥æ–°é”™é¢˜</text>
      <text class="quick-add-arrow">â†’</text>
    </view>
  </view>
</view>
